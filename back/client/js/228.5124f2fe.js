"use strict";(globalThis["webpackChunkauth_frontend"]=globalThis["webpackChunkauth_frontend"]||[]).push([[228],{3228:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var n=a(9835);const o={key:0,id:"q-app",style:{"min-height":"100vh"}};function s(e,t,a,s,i,d){const l=(0,n.up)("NoteComponent"),r=(0,n.up)("q-input"),u=(0,n.up)("q-btn"),c=(0,n.up)("q-card-section"),h=(0,n.up)("q-separator"),m=(0,n.up)("q-card"),p=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(p,{class:"row items-center justify-evenly container"},{default:(0,n.w5)((()=>[e.auth?((0,n.wg)(),(0,n.iD)("div",o,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.userData,(t=>((0,n.wg)(),(0,n.j4)(l,{key:t._id,userData:t,onDeleteOnClientSide:e.deleteOnClientSide,onEditOnClientSide:e.editOnClientSide},null,8,["userData","onDeleteOnClientSide","onEditOnClientSide"])))),128)),(0,n.Wm)(m,{flat:"",bordered:"",class:"my-card q-ma-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{class:"bg-primary relative-position q-pa-xs"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{class:"q-ml-sm inline",dense:!0,modelValue:e.dataHeader,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dataHeader=t),label:"Заголовок"},null,8,["modelValue"]),(0,n.Wm)(u,{color:"secondary",class:"q-ma-none q-ma-xs float-right",label:"Создать запись",onClick:e.newData},null,8,["onClick"])])),_:1}),(0,n.Wm)(h),(0,n.Wm)(c,{class:"q-pa-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{class:"q-ml-sm q-mb-sm",modelValue:e.dataBody,"onUpdate:modelValue":t[1]||(t[1]=t=>e.dataBody=t),label:"Новая запись"},null,8,["modelValue"])])),_:1})])),_:1})])):((0,n.wg)(),(0,n.j4)(m,{key:1,rounded:"",class:"my-card relative-position log-in-container bg-primary"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{class:"absolute-top text-h6 text-center"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Для начала работы авторизуйтесь! ")])),_:1})])),_:1}))])),_:1})}var i=a(499),d=a(6970);const l={key:0},r={key:0,class:"text-h5 inline q-ma-sm"},u={class:"inline"},c={key:1},h={class:"inline text-h5 q-ma-sm"},m={class:"inline"};function p(e,t,a,o,s,i){const p=(0,n.up)("q-input"),y=(0,n.up)("q-btn"),f=(0,n.up)("q-card-section"),b=(0,n.up)("q-separator"),g=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(g,{flat:"",bordered:"",class:"my-card q-ma-md"},{default:(0,n.w5)((()=>[e.isEditModeOn?((0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(f,{class:"bg-primary q-pa-none header-section text-justify"},{default:(0,n.w5)((()=>[e.userData.role?((0,n.wg)(),(0,n.iD)("div",r,(0,d.zw)(e.header),1)):((0,n.wg)(),(0,n.j4)(p,{key:1,dense:!0,class:"inline q-pa-xs q-ml-sm q-my-auto header-section text-h5",modelValue:e.header,"onUpdate:modelValue":t[0]||(t[0]=t=>e.header=t)},null,8,["modelValue"])),(0,n._)("div",u,[(0,n.Wm)(y,{class:"q-ma-xs",color:"secondary",label:"Сохранить",onClick:e.saveEditNote},null,8,["onClick"]),(0,n.Wm)(y,{class:"q-ma-xs",color:"secondary",label:"Назад",onClick:e.editModToogle},null,8,["onClick"])])])),_:1}),(0,n.Wm)(b),(0,n.Wm)(f,{class:"q-pa-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{class:"q-ml-sm q-mb-sm",modelValue:e.body,"onUpdate:modelValue":t[1]||(t[1]=t=>e.body=t)},null,8,["modelValue"])])),_:1})])):((0,n.wg)(),(0,n.iD)("div",c,[(0,n.Wm)(f,{class:"bg-primary q-pa-none header-section text-justify"},{default:(0,n.w5)((()=>[(0,n._)("span",h,(0,d.zw)(e.header),1),(0,n._)("div",m,[(0,n.Wm)(y,{class:"q-ma-xs",color:"secondary",label:"Редактировать",onClick:e.editModToogle},null,8,["onClick"]),e.userData.role?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(y,{key:0,class:"q-ma-xs",color:"secondary",label:"Удалить",onClick:e.deleteNote},null,8,["onClick"]))])])),_:1}),(0,n.Wm)(b),(0,n.Wm)(f,{class:"q-pa-sm body-section"},{default:(0,n.w5)((()=>[(0,n._)("div",null,(0,d.zw)(e.body),1)])),_:1})]))])),_:1})}var y=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function d(e){try{l(n["throw"](e))}catch(t){s(t)}}function l(e){e.done?a(e.value):o(e.value).then(i,d)}l((n=n.apply(e,t||[])).next())}))};const f=(0,n.aZ)({name:"NoteComponent",props:["userData"],data(){return{header:this.userData.header,body:this.userData.body,isEditModeOn:!1,backup:{header:"",body:""}}},methods:{deleteNote(){this.$axios.delete("/user-data/"+this.userData._id).then((e=>{this.$emit("deleteOnClientSide",this.userData._id)})).catch((e=>{console.log(e)}))},saveEditNote(){return y(this,void 0,void 0,(function*(){const e={header:this.header,body:this.body,role:this.userData.role};yield this.$axios.patch("/user-data/"+this.userData._id,e).then((e=>{this.isEditModeOn=!this.isEditModeOn,this.$emit("editOnClientSide",e.data)})).catch((e=>{console.log(e)}))}))},editModToogle(){this.isEditModeOn?(this.header=this.backup.header,this.body=this.backup.body):this.backup={header:this.header,body:this.body},this.isEditModeOn=!this.isEditModeOn}}});var b=a(1639),g=a(4458),q=a(3190),D=a(6867),w=a(7065),v=a(926),k=a(9984),C=a.n(k);const x=(0,b.Z)(f,[["render",p]]),_=x;C()(f,"components",{QCard:g.Z,QCardSection:q.Z,QInput:D.Z,QBtn:w.Z,QSeparator:v.Z});var W=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function d(e){try{l(n["throw"](e))}catch(t){s(t)}}function l(e){e.done?a(e.value):o(e.value).then(i,d)}l((n=n.apply(e,t||[])).next())}))};const O=(0,n.aZ)({name:"IndexPage",components:{NoteComponent:_},data(){return{userData:[],dataHeader:(0,i.iH)(""),dataBody:(0,i.iH)(""),auth:""}},methods:{newData(){return W(this,void 0,void 0,(function*(){const e={header:this.dataHeader,body:this.dataBody};yield this.$axios.put("/user-data",e,{headers:{authorization:localStorage.getItem("AuthToken")}}).then((e=>{this.userData.push(e.data),this.dataHeader="",this.dataBody=""})).catch((e=>{console.log(e)}))}))},deleteOnClientSide(e){this.userData.splice(this.userData.findIndex((t=>t._id===e)),1)},editOnClientSide(e){let t=this.userData.findIndex((t=>t._id===e._id));-1===t&&(t=this.userData.findIndex((t=>t.role===e.role))),this.userData.splice(t,1,e)}},created(){this.$axios.interceptors.response.use((e=>e),(e=>W(this,void 0,void 0,(function*(){var t;return 403===(null===(t=null===e||void 0===e?void 0:e.response)||void 0===t?void 0:t.status)&&(localStorage.setItem("AuthToken",""),this.$router.go(0)),e})))),this.auth=localStorage.getItem("AuthToken")||"",this.$axios.get("/user-data").then((e=>{this.userData=e.data,this.userData.find((e=>"email"===e.role))||this.userData.push({header:"E-mail",body:"",role:"email"}),this.userData.find((e=>"tel"===e.role))||this.userData.push({header:"Телефон",body:"",role:"tel"}),this.userData.find((e=>"address"===e.role))||this.userData.push({header:"Адрес",body:"",role:"address"}),this.userData.find((e=>"info"===e.role))||this.userData.push({header:"О себе",body:"",role:"info"})})).catch((e=>{console.log(e)}))}});var S=a(9885);const Z=(0,b.Z)(O,[["render",s]]),E=Z;C()(O,"components",{QPage:S.Z,QCard:g.Z,QCardSection:q.Z,QInput:D.Z,QBtn:w.Z,QSeparator:v.Z})}}]);